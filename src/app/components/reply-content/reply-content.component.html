<div>
  <div class="flex flex-row justify-between">
    <div class="flex flex-row gap-2 items-end">
      <div class="font-bold text-2xl mb-1">Discussion</div>
      <button (click)="isOpen = !isOpen" class="font-extrabold">
        <mat-icon
          fontIcon="add_circle_outline"
          style="color: #136afa"
        ></mat-icon>
      </button>
    </div>
    <div class="flex justify-center items-center gap-2">
      <button
        class="cursor-pointer flex mb-2 border-2 border-[#136afa] font-bold p-2 rounded-xl"
        (click)="changeSort()"
      >
        Sort By: <span *ngIf="isSort" class="pl-1"> Newest first</span>
        <span *ngIf="!isSort" class="pl-1"> Oldest first</span>
      </button>
      <button (click)="changeSort()">
        <svg
          class="mb-2"
          *ngIf="isSort"
          xmlns="http://www.w3.org/2000/svg"
          width="25"
          height="25"
          viewBox="0 0 512 512"
        >
          <path
            fill="#136afa"
            d="M256 504c137 0 248-111 248-248S393 8 256 8S8 119 8 256s111 248 248 248zm0-448c110.5 0 200 89.5 200 200s-89.5 200-200 200S56 366.5 56 256S145.5 56 256 56zm20 328h-40c-6.6 0-12-5.4-12-12V256h-67c-10.7 0-16-12.9-8.5-20.5l99-99c4.7-4.7 12.3-4.7 17 0l99 99c7.6 7.6 2.2 20.5-8.5 20.5h-67v116c0 6.6-5.4 12-12 12z"
          />
        </svg>
        <svg
          class="mb-2"
          *ngIf="!isSort"
          xmlns="http://www.w3.org/2000/svg"
          width="25"
          height="25"
          viewBox="0 0 512 512"
        >
          <path
            fill="#136afa"
            d="M256 8C119 8 8 119 8 256s111 248 248 248s248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200s-89.5 200-200 200zm-32-316v116h-67c-10.7 0-16 12.9-8.5 20.5l99 99c4.7 4.7 12.3 4.7 17 0l99-99c7.6-7.6 2.2-20.5-8.5-20.5h-67V140c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12z"
          />
        </svg>
      </button>
    </div>
  </div>
  <div>
    <form
      [formGroup]="submitForm"
      (ngSubmit)="onSubmit($event)"
      onsubmit="event.preventDefault()"
    >
      <div *ngIf="isOpen" class="flex gap-2 items-center justify-center">
        <input
          class="w-full flex p-3 bg-[#f8f8ff] border-2 border-black rounded-md"
          type="text"
          placeholder="Type your Reply"
          formControlName="ip"
        />
        <button (click)="onSubmit($event)">
          <svg
            *ngIf="submitTrue == 1"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 512 512"
          >
            <path
              fill="currentColor"
              d="M504 256C504 119 393 8 256 8S8 119 8 256s111 248 248 248s248-111 248-248zm-448 0c0-110.5 89.5-200 200-200s200 89.5 200 200s-89.5 200-200 200S56 366.5 56 256zm72 20v-40c0-6.6 5.4-12 12-12h116v-67c0-10.7 12.9-16 20.5-8.5l99 99c4.7 4.7 4.7 12.3 0 17l-99 99c-7.6 7.6-20.5 2.2-20.5-8.5v-67H140c-6.6 0-12-5.4-12-12z"
            />
          </svg>
          <div class="bg-white">
            <svg
              *ngIf="submitTrue == 0"
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 24 24"
            >
              <circle cx="4" cy="12" r="3" fill="currentColor">
                <animate
                  id="svgSpinners3DotsBounce0"
                  attributeName="cy"
                  begin="0;svgSpinners3DotsBounce1.end+0.25s"
                  calcMode="spline"
                  dur="0.6s"
                  keySplines=".33,.66,.66,1;.33,0,.66,.33"
                  values="12;6;12"
                />
              </circle>
              <circle cx="12" cy="12" r="3" fill="currentColor">
                <animate
                  attributeName="cy"
                  begin="svgSpinners3DotsBounce0.begin+0.1s"
                  calcMode="spline"
                  dur="0.6s"
                  keySplines=".33,.66,.66,1;.33,0,.66,.33"
                  values="12;6;12"
                />
              </circle>
              <circle cx="20" cy="12" r="3" fill="currentColor">
                <animate
                  id="svgSpinners3DotsBounce1"
                  attributeName="cy"
                  begin="svgSpinners3DotsBounce0.begin+0.2s"
                  calcMode="spline"
                  dur="0.6s"
                  keySplines=".33,.66,.66,1;.33,0,.66,.33"
                  values="12;6;12"
                />
              </circle>
            </svg>
          </div>
        </button>
      </div>
    </form>
    <div>
      <div
        *ngIf="problemDetails[0] && problemDetails[0].replyMain[0].reply"
        class="flex flex-col gap-4 bg-[#f6f6f6] border-2 border-[#136afa] justify-center rounded-2xl drop-shadow-lg p-4 mt-4"
      >
        <svg
          *ngIf="loadTrue == 1"
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          viewBox="0 0 33 33"
        >
          <rect width="2.8" height="12" x="1" y="6" fill="currentColor">
            <animate
              attributeName="y"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.4s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="6;1;6"
            />
            <animate
              attributeName="height"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.4s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="12;22;12"
            />
          </rect>
          <rect width="2.8" height="12" x="5.8" y="6" fill="currentColor">
            <animate
              attributeName="y"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.2s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="6;1;6"
            />
            <animate
              attributeName="height"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.2s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="12;22;12"
            />
          </rect>
          <rect width="2.8" height="12" x="10.6" y="6" fill="currentColor">
            <animate
              id="svgSpinnersBarsScaleMiddle0"
              attributeName="y"
              begin="0;svgSpinnersBarsScaleMiddle1.end-0.1s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="6;1;6"
            />
            <animate
              attributeName="height"
              begin="0;svgSpinnersBarsScaleMiddle1.end-0.1s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="12;22;12"
            />
          </rect>
          <rect width="2.8" height="12" x="15.4" y="6" fill="currentColor">
            <animate
              attributeName="y"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.2s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="6;1;6"
            />
            <animate
              attributeName="height"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.2s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="12;22;12"
            />
          </rect>
          <rect width="2.8" height="12" x="20.2" y="6" fill="currentColor">
            <animate
              id="svgSpinnersBarsScaleMiddle1"
              attributeName="y"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.4s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="6;1;6"
            />
            <animate
              attributeName="height"
              begin="svgSpinnersBarsScaleMiddle0.begin+0.4s"
              calcMode="spline"
              dur="0.6s"
              keySplines=".14,.73,.34,1;.65,.26,.82,.45"
              values="12;22;12"
            />
          </rect>
        </svg>
        <div *ngIf="!isSort">
          <div *ngFor="let item of p2">
            <div class="flex flex-row items-center gap-2">
              <div
                *ngIf="
                  item.user.profileImg != '' && item.user.profileImg != null
                "
              >
                <img
                  [src]="item.user.profileImg"
                  class="h-20 w-20 rounded-full object-cover max-sm:h-8 max-sm:w-10"
                />
              </div>
              <div
                *ngIf="
                  item.user.profileImg == '' || item.user.profileImg == null
                "
              >
                <img
                  [src]="defaultUrl"
                  class="h-20 w-20 rounded-full object-cover max-sm:h-8 max-sm:w-10"
                />
              </div>
              <div class="flex flex-col w-full">
                <div class="flex flex-row items-center justify-between">
                  <div
                    class="font-extrabold text-xl"
                    *ngIf="item.user.name == null || item.user.name == ''"
                  >
                    Anonymous
                  </div>
                  <div
                    class="font-extrabold text-xl"
                    *ngIf="item.user.name != null || item.user.name != ''"
                  >
                    {{ item.user.name }}
                  </div>

                  <div class="text-xl text-gray-500">
                    {{ item.reply.createdAt | date : "mediumDate" }}
                  </div>
                </div>
                <div class="text-xl">
                  {{ item.reply.content }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="isSort">
          <div *ngFor="let item of p1">
            <div class="flex flex-row items-center gap-2">
              <div
                *ngIf="
                  item.user.profileImg != '' && item.user.profileImg != null
                "
              >
                <img
                  [src]="item.user.profileImg"
                  class="h-20 w-20 rounded-full object-cover max-sm:h-8 max-sm:w-10"
                />
              </div>
              <div
                *ngIf="
                  item.user.profileImg == '' || item.user.profileImg == null
                "
              >
                <img
                  [src]="defaultUrl"
                  class="h-20 w-20 rounded-full object-cover max-sm:h-8 max-sm:w-10"
                />
              </div>
              <div class="flex flex-col w-full">
                <div class="flex flex-row items-center justify-between">
                  <div
                    class="font-extrabold text-xl"
                    *ngIf="item.user.name == null || item.user.name == ''"
                  >
                    Anonymous
                  </div>
                  <div
                    class="font-extrabold text-xl"
                    *ngIf="item.user.name != null || item.user.name != ''"
                  >
                    {{ item.user.name }}
                  </div>

                  <div class="text-xl text-gray-500">
                    {{ item.reply.createdAt | date : "mediumDate" }}
                  </div>
                </div>
                <div class="text-xl">
                  {{ item.reply.content }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
